#!/usr/bin/env bash

set -e

if [ $# != 2 ]; then
  printf "argment error!\n"
  exit 1
fi

REPOROOT=~/code/repos
REFERENCE_DIR=~/references

url=$1
repo=${url#https://github.com/}
name=${url##*/}

ghq get $url > /dev/null 2>&1 && printf "  [+] cloned $repo\n"

cd ${REPOROOT}/github.com/${repo%/$name}

if [ ! -e ${REFERENCE_DIR}/$2 ]; then
  mkdir ${REFERENCE_DIR}/$2 && printf "  [+] created $2 folder\n"
fi
ln -sfn $PWD/$name ${REFERENCE_DIR}/$2/$name && printf "  [+] linked $name\n"
